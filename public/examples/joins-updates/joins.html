<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Joins</title>
    <link rel="stylesheet" href="/css/global.css"/>
    <script src="/lib/lodash/lodash.js"></script>
    <script type="text/javascript" src="/lib/d3/d3.min.js"></script>
    <script type="text/javascript" src="/lib/jquery/dist/jquery.min.js"></script>
    <style>
        svg {background: lightgray}
        circle { fill-opacity: 0.5}
        .circle1 { fill: darkblue}
        .circle2 { fill: orange}
        .circle3 { fill: green}
    </style>
</head>
<body>
<a href="/joins"></a>
<p></p>
<svg width="700" height="700">
    <text></text>
</svg>

<script>

    setInterval(function () {
        // generate an randon array between 1 and 7 contain random numbers between 1,10
       var  data = _.times(_.random(1,30), _.partial(_.random, 1, 10, false));


        d3.select('svg')
                .selectAll('text')
                .text(data.length)
                .attr('dy', '0.35em')
                .attr('x', 10)
                .attr('y',10);


        var circles = d3.select('svg')
                .selectAll("circle")
                .data(data);


        // Enter (new items)
        circles.enter().append("circle")
                .attr("r", function (d) {
                    return d * 20;
                })
                .attr("cx", function (d) {
                    return d * 100;
                })
                .attr("cy", function (d) {
                    return d * 100

                })
                .attr("class", function (d,i) {
                    return 'circle'+(++i);
                });

        // update existing
        circles.attr("r", function (d) {
                    return d * 20;
                })
                .attr("cx", function (d) {
                    return d * 100;
                })
                .attr("cy", function (d) {
                    return d * 100

                })
                .attr("class", function (d,i) {
                    return 'circle'+(++i);
                });




        // Exit (remove spares)
        circles.exit().remove();

    }, 500)


</script>
</body>
</html>